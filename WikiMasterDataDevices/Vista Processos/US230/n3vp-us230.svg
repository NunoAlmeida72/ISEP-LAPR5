<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2789px" preserveAspectRatio="none" style="width:3694px;height:2789px;background:#FFFFFF;" version="1.1" viewBox="0 0 3694 2789" width="3694px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="2664.9141" style="stroke:#181818;stroke-width:1.0;" width="10" x="196" y="69.9609"/><rect fill="#FFFFFF" height="2604.2109" style="stroke:#181818;stroke-width:1.0;" width="10" x="425" y="100.3125"/><rect fill="#FFFFFF" height="2543.5078" style="stroke:#181818;stroke-width:1.0;" width="10" x="1393" y="130.6641"/><rect fill="#FFFFFF" height="32.6094" style="stroke:#181818;stroke-width:1.0;" width="10" x="1682" y="2338.0469"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1752.5" y="221.7188"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1752.5" y="2431.3594"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1752.5" y="2522.4141"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1752.5" y="2613.4688"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1915.5" y="161.0156"/><rect fill="#FFFFFF" height="182.1094" style="stroke:#181818;stroke-width:1.0;" width="10" x="1915.5" y="2401.0078"/><rect fill="#FFFFFF" height="93.3125" style="stroke:#181818;stroke-width:1.0;" width="10" x="2034" y="1134.1719"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2193.5" y="1033.1172"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2193.5" y="2138.9375"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2193.5" y="2229.9922"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="2441.5" y="972.4141"/><rect fill="#FFFFFF" height="182.1094" style="stroke:#181818;stroke-width:1.0;" width="10" x="2441.5" y="2108.5859"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2656" y="373.4766"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="2831" y="312.7734"/><rect fill="#FFFFFF" height="214.7188" style="stroke:#181818;stroke-width:1.0;" width="10" x="2915.5" y="651.6406"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2990" y="550.5859"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2990" y="1894.125"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2990" y="1985.1797"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="3158" y="489.8828"/><rect fill="#FFFFFF" height="182.1094" style="stroke:#181818;stroke-width:1.0;" width="10" x="3158" y="1863.7734"/><rect fill="#FFFFFF" height="93.3125" style="stroke:#181818;stroke-width:1.0;" width="10" x="3243.5" y="1495.2969"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="3333" y="1394.2422"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="3333" y="1649.3125"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="3333" y="1740.3672"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="3516" y="1333.5391"/><rect fill="#FFFFFF" height="182.1094" style="stroke:#181818;stroke-width:1.0;" width="10" x="3516" y="1618.9609"/><rect fill="none" height="468.5313" style="stroke:#000000;stroke-width:1.5;" width="1969" x="1341" y="449.1797"/><rect fill="none" height="347.125" style="stroke:#000000;stroke-width:1.5;" width="1332.5" x="1341" y="931.7109"/><rect fill="none" height="516.2344" style="stroke:#000000;stroke-width:1.5;" width="2342" x="1341" y="1292.8359"/><rect fill="none" height="230.8125" style="stroke:#000000;stroke-width:1.5;" width="1938" x="1341" y="1823.0703"/><rect fill="none" height="230.8125" style="stroke:#000000;stroke-width:1.5;" width="1301.5" x="1341" y="2067.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="200.5" x2="200.5" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="429.5" x2="429.5" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1398" x2="1398" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1686.5" x2="1686.5" y1="2337" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1757.5" x2="1757.5" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1920" x2="1920" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2039" x2="2039" y1="1133.125" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2198" x2="2198" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2446.5" x2="2446.5" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2573.5" x2="2573.5" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2660.5" x2="2660.5" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2836" x2="2836" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2920" x2="2920" y1="650.5938" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2995" x2="2995" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3162.5" x2="3162.5" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3248.5" x2="3248.5" y1="1494.25" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3337.5" x2="3337.5" y1="37.6094" y2="2752.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3521" x2="3521" y1="37.6094" y2="2752.875"/><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="158.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="165.5" y="26.5332">FloorRoute</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="158.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="165.5" y="2773.4082">FloorRoute</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="375.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="382.5" y="26.5332">FloorController</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="375.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="382.5" y="2773.4082">FloorController</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="1351" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="1358" y="26.5332">FloorService</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="1351" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="1358" y="2773.4082">FloorService</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="1663.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1670.5" y="2773.4082">Floor</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="1720.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1727.5" y="26.5332">FloorMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="1720.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1727.5" y="2773.4082">FloorMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="1880" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1887" y="26.5332">FloorRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="1880" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1887" y="2773.4082">FloorRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="1971" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="1978" y="2773.4082">BuildingConnection</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="2117" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="2124" y="26.5332">BuildingConnectionMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="2117" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="2124" y="2773.4082">BuildingConnectionMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="170" x="2361.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2368.5" y="26.5332">BuildingConnectionRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="170" x="2361.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2368.5" y="2773.4082">BuildingConnectionRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="2541.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="2548.5" y="26.5332">Building</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="2541.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="2548.5" y="2773.4082">Building</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="2615.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="2622.5" y="26.5332">BuildingMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="2615.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="2622.5" y="2773.4082">BuildingMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="2787" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="2794" y="26.5332">BuildingRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="2787" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="2794" y="2773.4082">BuildingRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="2895" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="2902" y="2773.4082">Room</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="2956" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="2963" y="26.5332">RoomMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="2956" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="2963" y="2773.4082">RoomMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="3120.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="3127.5" y="26.5332">RoomRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="3120.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="3127.5" y="2773.4082">RoomRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="3215.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="3222.5" y="2773.4082">Elevator</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="3291.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="3298.5" y="26.5332">ElevatorMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="3291.5" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="3298.5" y="2773.4082">ElevatorMap</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="3471" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="3478" y="26.5332">ElevatorRepo</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="3471" y="2751.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="3478" y="2773.4082">ElevatorRepo</text><rect fill="#FFFFFF" height="2664.9141" style="stroke:#181818;stroke-width:1.0;" width="10" x="196" y="69.9609"/><rect fill="#FFFFFF" height="2604.2109" style="stroke:#181818;stroke-width:1.0;" width="10" x="425" y="100.3125"/><rect fill="#FFFFFF" height="2543.5078" style="stroke:#181818;stroke-width:1.0;" width="10" x="1393" y="130.6641"/><rect fill="#FFFFFF" height="32.6094" style="stroke:#181818;stroke-width:1.0;" width="10" x="1682" y="2338.0469"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1752.5" y="221.7188"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1752.5" y="2431.3594"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1752.5" y="2522.4141"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1752.5" y="2613.4688"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1915.5" y="161.0156"/><rect fill="#FFFFFF" height="182.1094" style="stroke:#181818;stroke-width:1.0;" width="10" x="1915.5" y="2401.0078"/><rect fill="#FFFFFF" height="93.3125" style="stroke:#181818;stroke-width:1.0;" width="10" x="2034" y="1134.1719"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2193.5" y="1033.1172"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2193.5" y="2138.9375"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2193.5" y="2229.9922"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="2441.5" y="972.4141"/><rect fill="#FFFFFF" height="182.1094" style="stroke:#181818;stroke-width:1.0;" width="10" x="2441.5" y="2108.5859"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2656" y="373.4766"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="2831" y="312.7734"/><rect fill="#FFFFFF" height="214.7188" style="stroke:#181818;stroke-width:1.0;" width="10" x="2915.5" y="651.6406"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2990" y="550.5859"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2990" y="1894.125"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2990" y="1985.1797"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="3158" y="489.8828"/><rect fill="#FFFFFF" height="182.1094" style="stroke:#181818;stroke-width:1.0;" width="10" x="3158" y="1863.7734"/><rect fill="#FFFFFF" height="93.3125" style="stroke:#181818;stroke-width:1.0;" width="10" x="3243.5" y="1495.2969"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="3333" y="1394.2422"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="3333" y="1649.3125"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="3333" y="1740.3672"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="3516" y="1333.5391"/><rect fill="#FFFFFF" height="182.1094" style="stroke:#181818;stroke-width:1.0;" width="10" x="3516" y="1618.9609"/><polygon fill="#181818" points="184,65.9609,194,69.9609,184,73.9609,188,69.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="0" x2="190" y1="69.9609" y2="69.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="7" y="65.1045">Patch /floors/load-maps  (json)</text><polygon fill="#181818" points="413,96.3125,423,100.3125,413,104.3125,417,100.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="206" x2="419" y1="100.3125" y2="100.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="213" y="95.4561">loadMap(json)</text><polygon fill="#181818" points="1381,126.6641,1391,130.6641,1381,134.6641,1385,130.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="435" x2="1387" y1="130.6641" y2="130.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="939" x="442" y="125.8076">loadMap(json.id as string,json.map as number[][],json.rooms as IRoomDTO[],json.elevator as IElevatorDTO,json.buildingConnections as IBuildingConnectionDTO[])</text><polygon fill="#181818" points="1903.5,157.0156,1913.5,161.0156,1903.5,165.0156,1907.5,161.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="1909.5" y1="161.0156" y2="161.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="1410" y="156.1592">findByDomainId(floorId)</text><polygon fill="#181818" points="3681,187.3672,3691,191.3672,3681,195.3672,3685,191.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1925.5" x2="3687" y1="191.3672" y2="191.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="1932.5" y="186.5107">findOne(floorId)</text><polygon fill="#181818" points="1773.5,217.7188,1763.5,221.7188,1773.5,225.7188,1769.5,221.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1767.5" x2="1914.5" y1="221.7188" y2="221.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="1779.5" y="216.8623">Map2Model(floorData)</text><polygon fill="#181818" points="1903.5,248.0703,1913.5,252.0703,1903.5,256.0703,1907.5,252.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1757.5" x2="1909.5" y1="252.0703" y2="252.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="1764.5" y="247.2139">floor</text><polygon fill="#181818" points="1414,278.4219,1404,282.4219,1414,286.4219,1410,282.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="1919.5" y1="282.4219" y2="282.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="1420" y="277.5654">floor</text><polygon fill="#181818" points="2819,308.7734,2829,312.7734,2819,316.7734,2823,312.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="2825" y1="312.7734" y2="312.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="1410" y="307.917">findByDomainId(floor.buildingId)</text><polygon fill="#181818" points="3681,339.125,3691,343.125,3681,347.125,3685,343.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2841" x2="3687" y1="343.125" y2="343.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="2848" y="338.2686">findOne(floor.buildingId)</text><polygon fill="#181818" points="2677,369.4766,2667,373.4766,2677,377.4766,2673,373.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2671" x2="2830" y1="373.4766" y2="373.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="2683" y="368.6201">Map2Model(buildingData)</text><polygon fill="#181818" points="2819,399.8281,2829,403.8281,2819,407.8281,2823,403.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2661" x2="2825" y1="403.8281" y2="403.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="2668" y="398.9717">building</text><polygon fill="#181818" points="1414,430.1797,1404,434.1797,1414,438.1797,1410,434.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2835" y1="434.1797" y2="434.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="1420" y="429.3232">building</text><path d="M1341,449.1797 L1414,449.1797 L1414,457.5313 L1404,467.5313 L1341,467.5313 L1341,449.1797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="468.5313" style="stroke:#000000;stroke-width:1.5;" width="1969" x="1341" y="449.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1356" y="463.6748">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="190" x="1429" y="462.5986">[foreach roomDTO  of IRoomDTO[]]</text><polygon fill="#181818" points="3146,485.8828,3156,489.8828,3146,493.8828,3150,489.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="3152" y1="489.8828" y2="489.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="1410" y="485.0264">findByDomainId(roomDTO.id)</text><polygon fill="#181818" points="3681,516.2344,3691,520.2344,3681,524.2344,3685,520.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3168" x2="3687" y1="520.2344" y2="520.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="3175" y="515.3779">findOne(roomDTO.id)</text><polygon fill="#181818" points="3011,546.5859,3001,550.5859,3011,554.5859,3007,550.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3005" x2="3157" y1="550.5859" y2="550.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="3017" y="545.7295">Map2Model(roomData)</text><polygon fill="#181818" points="3146,576.9375,3156,580.9375,3146,584.9375,3150,580.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2995" x2="3152" y1="580.9375" y2="580.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="3002" y="576.0811">room</text><polygon fill="#181818" points="1414,607.2891,1404,611.2891,1414,615.2891,1410,611.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="3162" y1="611.2891" y2="611.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="1420" y="606.4326">room</text><polygon fill="#181818" points="2883,637.6406,2893,641.6406,2883,645.6406,2887,641.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="2889" y1="641.6406" y2="641.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="1410" y="636.7842">setPosX(roomDTO.posX)</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="2895" y="619.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="2902" y="640.8223">Room</text><polygon fill="#181818" points="1414,680.25,1404,684.25,1414,688.25,1410,684.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2914.5" y1="684.25" y2="684.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="1420" y="679.3936">room</text><polygon fill="#181818" points="2903.5,710.6016,2913.5,714.6016,2903.5,718.6016,2907.5,714.6016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="2909.5" y1="714.6016" y2="714.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="1410" y="709.7451">setPosY(roomDTO.posY)</text><polygon fill="#181818" points="1414,740.9531,1404,744.9531,1414,748.9531,1410,744.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2914.5" y1="744.9531" y2="744.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="1420" y="740.0967">room</text><polygon fill="#181818" points="2903.5,771.3047,2913.5,775.3047,2903.5,779.3047,2907.5,775.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="2909.5" y1="775.3047" y2="775.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="1410" y="770.4482">setWidth(roomDTO.width)</text><polygon fill="#181818" points="1414,801.6563,1404,805.6563,1414,809.6563,1410,805.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2914.5" y1="805.6563" y2="805.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="1420" y="800.7998">room</text><polygon fill="#181818" points="2903.5,832.0078,2913.5,836.0078,2903.5,840.0078,2907.5,836.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="2909.5" y1="836.0078" y2="836.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="1410" y="831.1514">setHeight(roomDTO.height)</text><polygon fill="#181818" points="1414,862.3594,1404,866.3594,1414,870.3594,1410,866.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2919.5" y1="866.3594" y2="866.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="1420" y="861.5029">room</text><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="1445" y1="896.7109" y2="896.7109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1445" x2="1445" y1="896.7109" y2="909.7109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1404" x2="1445" y1="909.7109" y2="909.7109"/><polygon fill="#181818" points="1414,905.7109,1404,909.7109,1414,913.7109,1410,909.7109" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="1410" y="891.8545">rooms.push(room)</text><path d="M1341,931.7109 L1414,931.7109 L1414,940.0625 L1404,950.0625 L1341,950.0625 L1341,931.7109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="347.125" style="stroke:#000000;stroke-width:1.5;" width="1332.5" x="1341" y="931.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1356" y="946.2061">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="339" x="1429" y="945.1299">[foreach buildingConnectionDTO of IBuildingConnectionDTO[]]</text><polygon fill="#181818" points="2429.5,968.4141,2439.5,972.4141,2429.5,976.4141,2433.5,972.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="2435.5" y1="972.4141" y2="972.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="1410" y="967.5576">findByDomainId(buildingConnectionDTO.id)</text><polygon fill="#181818" points="3681,998.7656,3691,1002.7656,3681,1006.7656,3685,1002.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2451.5" x2="3687" y1="1002.7656" y2="1002.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="2458.5" y="997.9092">findOne(buildingConnectionDTO.id)</text><polygon fill="#181818" points="2214.5,1029.1172,2204.5,1033.1172,2214.5,1037.1172,2210.5,1033.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2208.5" x2="2440.5" y1="1033.1172" y2="1033.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="2220.5" y="1028.2607">Map2Model(buildingConnectionData)</text><polygon fill="#181818" points="2429.5,1059.4688,2439.5,1063.4688,2429.5,1067.4688,2433.5,1063.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2198.5" x2="2435.5" y1="1063.4688" y2="1063.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="2205.5" y="1058.6123">buildingConnection</text><polygon fill="#181818" points="1414,1089.8203,1404,1093.8203,1414,1097.8203,1410,1093.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2445.5" y1="1093.8203" y2="1093.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1420" y="1088.9639">buildingConnection</text><polygon fill="#181818" points="1959,1120.1719,1969,1124.1719,1959,1128.1719,1963,1124.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="1965" y1="1124.1719" y2="1124.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="1410" y="1119.3154">setPosX(buildingConnectionDTO.posX)</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="1971" y="1101.8203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="1978" y="1123.3535">BuildingConnection</text><polygon fill="#181818" points="1414,1162.7813,1404,1166.7813,1414,1170.7813,1410,1166.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2033" y1="1166.7813" y2="1166.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1420" y="1161.9248">buildingConnection</text><polygon fill="#181818" points="2022,1193.1328,2032,1197.1328,2022,1201.1328,2026,1197.1328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="2028" y1="1197.1328" y2="1197.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="1410" y="1192.2764">setPosY(buildingConnectionDTO.posY)</text><polygon fill="#181818" points="1414,1223.4844,1404,1227.4844,1414,1231.4844,1410,1227.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2038" y1="1227.4844" y2="1227.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1420" y="1222.6279">buildingConnection</text><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="1445" y1="1257.8359" y2="1257.8359"/><line style="stroke:#181818;stroke-width:1.0;" x1="1445" x2="1445" y1="1257.8359" y2="1270.8359"/><line style="stroke:#181818;stroke-width:1.0;" x1="1404" x2="1445" y1="1270.8359" y2="1270.8359"/><polygon fill="#181818" points="1414,1266.8359,1404,1270.8359,1414,1274.8359,1410,1270.8359" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265" x="1410" y="1252.9795">buildingConnections.push(buildingConnection)</text><path d="M1341,1292.8359 L1402,1292.8359 L1402,1301.1875 L1392,1311.1875 L1341,1311.1875 L1341,1292.8359 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="516.2344" style="stroke:#000000;stroke-width:1.5;" width="2342" x="1341" y="1292.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1356" y="1307.3311">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="88" x="1417" y="1306.2549">[elevator != null]</text><polygon fill="#181818" points="3504,1329.5391,3514,1333.5391,3504,1337.5391,3508,1333.5391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="3510" y1="1333.5391" y2="1333.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="1410" y="1328.6826">findByDomainId(elevatorDTO.id)</text><polygon fill="#181818" points="3681,1359.8906,3691,1363.8906,3681,1367.8906,3685,1363.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3526" x2="3687" y1="1363.8906" y2="1363.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="3533" y="1359.0342">findOne(elevatorDTO.id)</text><polygon fill="#181818" points="3354,1390.2422,3344,1394.2422,3354,1398.2422,3350,1394.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3348" x2="3515" y1="1394.2422" y2="1394.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="3360" y="1389.3857">Map2Model(elevatorData)</text><polygon fill="#181818" points="3504,1420.5938,3514,1424.5938,3504,1428.5938,3508,1424.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3338" x2="3510" y1="1424.5938" y2="1424.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="3345" y="1419.7373">elevator</text><polygon fill="#181818" points="1414,1450.9453,1404,1454.9453,1414,1458.9453,1410,1454.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="3520" y1="1454.9453" y2="1454.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="1420" y="1450.0889">elevator</text><polygon fill="#181818" points="3203.5,1481.2969,3213.5,1485.2969,3203.5,1489.2969,3207.5,1485.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="3209.5" y1="1485.2969" y2="1485.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="1410" y="1480.4404">setPosX(elevatorDTO.posX)</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="3215.5" y="1462.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="3222.5" y="1484.4785">Elevator</text><polygon fill="#181818" points="1414,1523.9063,1404,1527.9063,1414,1531.9063,1410,1527.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="3242.5" y1="1527.9063" y2="1527.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="1420" y="1523.0498">elevator</text><polygon fill="#181818" points="3231.5,1554.2578,3241.5,1558.2578,3231.5,1562.2578,3235.5,1558.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="3237.5" y1="1558.2578" y2="1558.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="1410" y="1553.4014">setPosY(elevatorDTO.posY)</text><polygon fill="#181818" points="1414,1584.6094,1404,1588.6094,1414,1592.6094,1410,1588.6094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="3247.5" y1="1588.6094" y2="1588.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="1420" y="1583.7529">elevator</text><polygon fill="#181818" points="3504,1614.9609,3514,1618.9609,3504,1622.9609,3508,1618.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="3510" y1="1618.9609" y2="1618.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1410" y="1614.1045">save(elevator)</text><polygon fill="#181818" points="3354,1645.3125,3344,1649.3125,3354,1653.3125,3350,1649.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3348" x2="3515" y1="1649.3125" y2="1649.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="3360" y="1644.4561">Map2Data(elevator)</text><polygon fill="#181818" points="3504,1675.6641,3514,1679.6641,3504,1683.6641,3508,1679.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3338" x2="3510" y1="1679.6641" y2="1679.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="3345" y="1674.8076">elevatorData</text><polygon fill="#181818" points="3681,1706.0156,3691,1710.0156,3681,1714.0156,3685,1710.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3526" x2="3687" y1="1710.0156" y2="1710.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="3533" y="1705.1592">save(elevatorData)</text><polygon fill="#181818" points="3354,1736.3672,3344,1740.3672,3354,1744.3672,3350,1740.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3348" x2="3515" y1="1740.3672" y2="1740.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="3360" y="1735.5107">Map2Model(elevatorSaved)</text><polygon fill="#181818" points="3504,1766.7188,3514,1770.7188,3504,1774.7188,3508,1770.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3338" x2="3510" y1="1770.7188" y2="1770.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="3345" y="1765.8623">savedElevator</text><polygon fill="#181818" points="1414,1797.0703,1404,1801.0703,1414,1805.0703,1410,1801.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="3520" y1="1801.0703" y2="1801.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="1420" y="1796.2139">savedElevator</text><path d="M1341,1823.0703 L1414,1823.0703 L1414,1831.4219 L1404,1841.4219 L1341,1841.4219 L1341,1823.0703 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="230.8125" style="stroke:#000000;stroke-width:1.5;" width="1938" x="1341" y="1823.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1356" y="1837.5654">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1429" y="1836.4893">[foreach room of rooms]</text><polygon fill="#181818" points="3146,1859.7734,3156,1863.7734,3146,1867.7734,3150,1863.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="3152" y1="1863.7734" y2="1863.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="1410" y="1858.917">save(room)</text><polygon fill="#181818" points="3011,1890.125,3001,1894.125,3011,1898.125,3007,1894.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3005" x2="3157" y1="1894.125" y2="1894.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="3017" y="1889.2686">Map2Data(room)</text><polygon fill="#181818" points="3146,1920.4766,3156,1924.4766,3146,1928.4766,3150,1924.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2995" x2="3152" y1="1924.4766" y2="1924.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="3002" y="1919.6201">roomData</text><polygon fill="#181818" points="3681,1950.8281,3691,1954.8281,3681,1958.8281,3685,1954.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3168" x2="3687" y1="1954.8281" y2="1954.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="3175" y="1949.9717">save(roomData)</text><polygon fill="#181818" points="3011,1981.1797,3001,1985.1797,3011,1989.1797,3007,1985.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="3005" x2="3157" y1="1985.1797" y2="1985.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="3017" y="1980.3232">Map2Model(roomSaved)</text><polygon fill="#181818" points="3146,2011.5313,3156,2015.5313,3146,2019.5313,3150,2015.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2995" x2="3152" y1="2015.5313" y2="2015.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="3002" y="2010.6748">savedRoom</text><polygon fill="#181818" points="1414,2041.8828,1404,2045.8828,1414,2049.8828,1410,2045.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="3162" y1="2045.8828" y2="2045.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="1420" y="2041.0264">savedRoom</text><path d="M1341,2067.8828 L1414,2067.8828 L1414,2076.2344 L1404,2086.2344 L1341,2086.2344 L1341,2067.8828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="230.8125" style="stroke:#000000;stroke-width:1.5;" width="1301.5" x="1341" y="2067.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1356" y="2082.3779">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="294" x="1429" y="2081.3018">[foreach buildingConnection  of buildingConnections]</text><polygon fill="#181818" points="2429.5,2104.5859,2439.5,2108.5859,2429.5,2112.5859,2433.5,2108.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="2435.5" y1="2108.5859" y2="2108.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="1410" y="2103.7295">save(buildingConnection)</text><polygon fill="#181818" points="2214.5,2134.9375,2204.5,2138.9375,2214.5,2142.9375,2210.5,2138.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2208.5" x2="2440.5" y1="2138.9375" y2="2138.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="2220.5" y="2134.0811">Map2Data(buildingConnection)</text><polygon fill="#181818" points="2429.5,2165.2891,2439.5,2169.2891,2429.5,2173.2891,2433.5,2169.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2198.5" x2="2435.5" y1="2169.2891" y2="2169.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="2205.5" y="2164.4326">buildingConnectionData</text><polygon fill="#181818" points="3681,2195.6406,3691,2199.6406,3681,2203.6406,3685,2199.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2451.5" x2="3687" y1="2199.6406" y2="2199.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="2458.5" y="2194.7842">save(buildingConnectionData)</text><polygon fill="#181818" points="2214.5,2225.9922,2204.5,2229.9922,2214.5,2233.9922,2210.5,2229.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2208.5" x2="2440.5" y1="2229.9922" y2="2229.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="2220.5" y="2225.1357">Map2Model(buildingConnectionSaved)</text><polygon fill="#181818" points="2429.5,2256.3438,2439.5,2260.3438,2429.5,2264.3438,2433.5,2260.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2198.5" x2="2435.5" y1="2260.3438" y2="2260.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="2205.5" y="2255.4873">savedBuildingConnection</text><polygon fill="#181818" points="1414,2286.6953,1404,2290.6953,1414,2294.6953,1410,2290.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="2445.5" y1="2290.6953" y2="2290.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="1420" y="2285.8389">savedBuildingConnection</text><polygon fill="#181818" points="1651.5,2324.0469,1661.5,2328.0469,1651.5,2332.0469,1655.5,2328.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="1657.5" y1="2328.0469" y2="2328.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="1410" y="2323.1904">setMap(map)</text><rect fill="#E3E3E3" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="1663.5" y="2305.6953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1670.5" y="2327.2285">Floor</text><polygon fill="#181818" points="1414,2366.6563,1404,2370.6563,1414,2374.6563,1410,2370.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="1686" y1="2370.6563" y2="2370.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="1420" y="2365.7998">floor</text><polygon fill="#181818" points="1903.5,2397.0078,1913.5,2401.0078,1903.5,2405.0078,1907.5,2401.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="1909.5" y1="2401.0078" y2="2401.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="1410" y="2396.1514">save(floor)</text><polygon fill="#181818" points="1773.5,2427.3594,1763.5,2431.3594,1773.5,2435.3594,1769.5,2431.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1767.5" x2="1914.5" y1="2431.3594" y2="2431.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="1779.5" y="2426.5029">Map2Data(floor)</text><polygon fill="#181818" points="1903.5,2457.7109,1913.5,2461.7109,1903.5,2465.7109,1907.5,2461.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1757.5" x2="1909.5" y1="2461.7109" y2="2461.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="1764.5" y="2456.8545">floorData</text><polygon fill="#181818" points="3681,2488.0625,3691,2492.0625,3681,2496.0625,3685,2492.0625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1925.5" x2="3687" y1="2492.0625" y2="2492.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="1932.5" y="2487.2061">save(floorData)</text><polygon fill="#181818" points="1773.5,2518.4141,1763.5,2522.4141,1773.5,2526.4141,1769.5,2522.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1767.5" x2="1914.5" y1="2522.4141" y2="2522.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="1779.5" y="2517.5576">Map2Model(floorSaved)</text><polygon fill="#181818" points="1903.5,2548.7656,1913.5,2552.7656,1903.5,2556.7656,1907.5,2552.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1757.5" x2="1909.5" y1="2552.7656" y2="2552.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="1764.5" y="2547.9092">savedFloor</text><polygon fill="#181818" points="1414,2579.1172,1404,2583.1172,1414,2587.1172,1410,2583.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="1919.5" y1="2583.1172" y2="2583.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="1420" y="2578.2607">savedFloor</text><polygon fill="#181818" points="1740.5,2609.4688,1750.5,2613.4688,1740.5,2617.4688,1744.5,2613.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="1746.5" y1="2613.4688" y2="2613.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="1410" y="2608.6123">Map2DTO(savedFloor)</text><polygon fill="#181818" points="1414,2639.8203,1404,2643.8203,1414,2647.8203,1410,2643.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1408" x2="1756.5" y1="2643.8203" y2="2643.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="1420" y="2638.9639">savedFloorDTO</text><polygon fill="#181818" points="446,2670.1719,436,2674.1719,446,2678.1719,442,2674.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440" x2="1397" y1="2674.1719" y2="2674.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="452" y="2669.3154">savedFloorDTO</text><polygon fill="#181818" points="217,2700.5234,207,2704.5234,217,2708.5234,213,2704.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="211" x2="429" y1="2704.5234" y2="2704.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="223" y="2699.667">response(savedFloorDTO as json)</text><polygon fill="#181818" points="11,2730.875,1,2734.875,11,2738.875,7,2734.875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="5" x2="200" y1="2734.875" y2="2734.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="17" y="2730.0186">response</text><!--MD5=[bd27044a62c73ca16de110153ee6ee0a]
@startuml
'http://plantuml.com/skinparam.html
skinparam monochrome true
skinparam packageStyle rect
skinparam shadowing false


participant FloorRoute  as route
participant  FloorController as controller
participant  FloorService as service
participant  Floor as domain
participant  FloorMap as mapper
participant  FloorRepo as repo

participant  BuildingConnection as BCdomain
participant  BuildingConnectionMap as BCmapper
participant  BuildingConnectionRepo as BCrepo

participant  Building as Bdomain
participant  BuildingMap as Bmapper
participant  BuildingRepo as Brepo

participant  Room as Rdomain
participant  RoomMap as Rmapper
participant  RoomRepo as Rrepo

participant  Elevator as Edomain
participant  ElevatorMap as Emapper
participant  ElevatorRepo as Erepo




-> route: Patch /floors/load-maps  (json)
activate route
  route->controller: loadMap(json)
  activate controller
    controller ->service:loadMap(json.id as string,json.map as number[][],json.rooms as IRoomDTO[],json.elevator as IElevatorDTO,json.buildingConnections as IBuildingConnectionDTO[])
    activate service
    service->repo:findByDomainId(floorId)
    activate repo
    repo -> :findOne(floorId)
    repo -> mapper:Map2Model(floorData)
    activate mapper
    mapper - -> repo:floor
    deactivate
    repo - -> service:floor
    deactivate

    service -> Brepo:findByDomainId(floor.buildingId)
    activate Brepo
    Brepo -> :findOne(floor.buildingId)
    Brepo -> Bmapper:Map2Model(buildingData)
    activate Bmapper
    Bmapper - -> Brepo:building
    deactivate
    Brepo - -> service:building
    deactivate

    loop foreach roomDTO  of IRoomDTO[] 
    service -> Rrepo:findByDomainId(roomDTO.id)
    activate Rrepo
    Rrepo -> :findOne(roomDTO.id)
    Rrepo -> Rmapper:Map2Model(roomData)
    activate Rmapper
    Rmapper - -> Rrepo:room
    deactivate
    Rrepo - -> service:room
    deactivate
    service -> Rdomain**:setPosX(roomDTO.posX)
    activate Rdomain
    Rdomain - -> service :room
    service -> Rdomain:setPosY(roomDTO.posY)
    Rdomain - -> service :room
    service -> Rdomain:setWidth(roomDTO.width)
    Rdomain - -> service :room
    service -> Rdomain:setHeight(roomDTO.height)
    Rdomain - -> service :room
    deactivate
    service->service:rooms.push(room)
    end

    loop foreach buildingConnectionDTO of IBuildingConnectionDTO[]
    service -> BCrepo:findByDomainId(buildingConnectionDTO.id)
    activate BCrepo
    BCrepo -> :findOne(buildingConnectionDTO.id)
    BCrepo -> BCmapper:Map2Model(buildingConnectionData)
    activate BCmapper
    BCmapper - -> BCrepo:buildingConnection
    deactivate
    BCrepo - -> service:buildingConnection
    deactivate
    service -> BCdomain**:setPosX(buildingConnectionDTO.posX)
    activate BCdomain
    BCdomain - -> service :buildingConnection
    service -> BCdomain:setPosY(buildingConnectionDTO.posY)
    BCdomain - -> service :buildingConnection
    deactivate
    service->service:buildingConnections.push(buildingConnection)
    end

    alt  elevator != null

    service -> Erepo:findByDomainId(elevatorDTO.id)
    activate Erepo
    Erepo -> :findOne(elevatorDTO.id)
    Erepo -> Emapper:Map2Model(elevatorData)
    activate Emapper
    Emapper - -> Erepo:elevator
    deactivate
    Erepo - -> service:elevator
    deactivate

    service -> Edomain**:setPosX(elevatorDTO.posX)
    activate Edomain
    Edomain - -> service :elevator
    service -> Edomain:setPosY(elevatorDTO.posY)
    Edomain - -> service :elevator
    deactivate
    service -> Erepo:save(elevator)
    activate Erepo
    Erepo  ->  Emapper:Map2Data(elevator)
    activate  Emapper
    Emapper- -> Erepo:elevatorData
    deactivate
    Erepo ->:save(elevatorData)
    Erepo -> Emapper: Map2Model(elevatorSaved)
    activate Emapper
    Emapper - ->  Erepo:savedElevator
    deactivate
    Erepo - -> service:savedElevator
    deactivate
    end

    loop foreach room of rooms
    service -> Rrepo:save(room)
    activate Rrepo
    Rrepo->Rmapper:Map2Data(room)
    activate Rmapper
    Rmapper - -> Rrepo: roomData
    deactivate
    Rrepo->:save(roomData)
    Rrepo->Rmapper:Map2Model(roomSaved)
    activate Rmapper
    Rmapper - -> Rrepo: savedRoom
    deactivate
    Rrepo  - -> service:savedRoom
    deactivate
    end

    loop foreach buildingConnection  of buildingConnections
    service -> BCrepo:save(buildingConnection)
    activate BCrepo
    BCrepo->BCmapper:Map2Data(buildingConnection)
    activate BCmapper
    BCmapper - -> BCrepo: buildingConnectionData
    deactivate
    BCrepo->:save(buildingConnectionData)
    BCrepo->BCmapper:Map2Model(buildingConnectionSaved)
    activate BCmapper
    BCmapper - -> BCrepo: savedBuildingConnection
    deactivate
    BCrepo  - -> service:savedBuildingConnection
    deactivate
    end

    service ->domain**:setMap(map)
    activate domain
    domain- ->service:floor
    deactivate

    service -> repo:save(floor)
    activate repo
    repo->mapper:Map2Data(floor)
    activate mapper
    mapper - -> repo: floorData
    deactivate
    repo->:save(floorData)
    repo->mapper:Map2Model(floorSaved)
    activate mapper
    mapper - -> repo: savedFloor
    deactivate
    repo  - -> service:savedFloor
    deactivate
    service -> mapper:Map2DTO(savedFloor)
    activate mapper
    mapper- -> service:savedFloorDTO
    deactivate
    service- -> controller:savedFloorDTO
    deactivate
    controller - -> route:response(savedFloorDTO as json)
    deactivate
    <- - route:response
    deactivate
@enduml

@startuml
skinparam monochrome true
skinparam packageStyle rect
skinparam shadowing false


participant FloorRoute  as route
participant  FloorController as controller
participant  FloorService as service
participant  Floor as domain
participant  FloorMap as mapper
participant  FloorRepo as repo

participant  BuildingConnection as BCdomain
participant  BuildingConnectionMap as BCmapper
participant  BuildingConnectionRepo as BCrepo

participant  Building as Bdomain
participant  BuildingMap as Bmapper
participant  BuildingRepo as Brepo

participant  Room as Rdomain
participant  RoomMap as Rmapper
participant  RoomRepo as Rrepo

participant  Elevator as Edomain
participant  ElevatorMap as Emapper
participant  ElevatorRepo as Erepo




-> route: Patch /floors/load-maps  (json)
activate route
  route->controller: loadMap(json)
  activate controller
    controller ->service:loadMap(json.id as string,json.map as number[][],json.rooms as IRoomDTO[],json.elevator as IElevatorDTO,json.buildingConnections as IBuildingConnectionDTO[])
    activate service
    service->repo:findByDomainId(floorId)
    activate repo
    repo -> :findOne(floorId)
    repo -> mapper:Map2Model(floorData)
    activate mapper
    mapper - -> repo:floor
    deactivate
    repo - -> service:floor
    deactivate

    service -> Brepo:findByDomainId(floor.buildingId)
    activate Brepo
    Brepo -> :findOne(floor.buildingId)
    Brepo -> Bmapper:Map2Model(buildingData)
    activate Bmapper
    Bmapper - -> Brepo:building
    deactivate
    Brepo - -> service:building
    deactivate

    loop foreach roomDTO  of IRoomDTO[] 
    service -> Rrepo:findByDomainId(roomDTO.id)
    activate Rrepo
    Rrepo -> :findOne(roomDTO.id)
    Rrepo -> Rmapper:Map2Model(roomData)
    activate Rmapper
    Rmapper - -> Rrepo:room
    deactivate
    Rrepo - -> service:room
    deactivate
    service -> Rdomain**:setPosX(roomDTO.posX)
    activate Rdomain
    Rdomain - -> service :room
    service -> Rdomain:setPosY(roomDTO.posY)
    Rdomain - -> service :room
    service -> Rdomain:setWidth(roomDTO.width)
    Rdomain - -> service :room
    service -> Rdomain:setHeight(roomDTO.height)
    Rdomain - -> service :room
    deactivate
    service->service:rooms.push(room)
    end

    loop foreach buildingConnectionDTO of IBuildingConnectionDTO[]
    service -> BCrepo:findByDomainId(buildingConnectionDTO.id)
    activate BCrepo
    BCrepo -> :findOne(buildingConnectionDTO.id)
    BCrepo -> BCmapper:Map2Model(buildingConnectionData)
    activate BCmapper
    BCmapper - -> BCrepo:buildingConnection
    deactivate
    BCrepo - -> service:buildingConnection
    deactivate
    service -> BCdomain**:setPosX(buildingConnectionDTO.posX)
    activate BCdomain
    BCdomain - -> service :buildingConnection
    service -> BCdomain:setPosY(buildingConnectionDTO.posY)
    BCdomain - -> service :buildingConnection
    deactivate
    service->service:buildingConnections.push(buildingConnection)
    end

    alt  elevator != null

    service -> Erepo:findByDomainId(elevatorDTO.id)
    activate Erepo
    Erepo -> :findOne(elevatorDTO.id)
    Erepo -> Emapper:Map2Model(elevatorData)
    activate Emapper
    Emapper - -> Erepo:elevator
    deactivate
    Erepo - -> service:elevator
    deactivate

    service -> Edomain**:setPosX(elevatorDTO.posX)
    activate Edomain
    Edomain - -> service :elevator
    service -> Edomain:setPosY(elevatorDTO.posY)
    Edomain - -> service :elevator
    deactivate
    service -> Erepo:save(elevator)
    activate Erepo
    Erepo  ->  Emapper:Map2Data(elevator)
    activate  Emapper
    Emapper- -> Erepo:elevatorData
    deactivate
    Erepo ->:save(elevatorData)
    Erepo -> Emapper: Map2Model(elevatorSaved)
    activate Emapper
    Emapper - ->  Erepo:savedElevator
    deactivate
    Erepo - -> service:savedElevator
    deactivate
    end

    loop foreach room of rooms
    service -> Rrepo:save(room)
    activate Rrepo
    Rrepo->Rmapper:Map2Data(room)
    activate Rmapper
    Rmapper - -> Rrepo: roomData
    deactivate
    Rrepo->:save(roomData)
    Rrepo->Rmapper:Map2Model(roomSaved)
    activate Rmapper
    Rmapper - -> Rrepo: savedRoom
    deactivate
    Rrepo  - -> service:savedRoom
    deactivate
    end

    loop foreach buildingConnection  of buildingConnections
    service -> BCrepo:save(buildingConnection)
    activate BCrepo
    BCrepo->BCmapper:Map2Data(buildingConnection)
    activate BCmapper
    BCmapper - -> BCrepo: buildingConnectionData
    deactivate
    BCrepo->:save(buildingConnectionData)
    BCrepo->BCmapper:Map2Model(buildingConnectionSaved)
    activate BCmapper
    BCmapper - -> BCrepo: savedBuildingConnection
    deactivate
    BCrepo  - -> service:savedBuildingConnection
    deactivate
    end

    service ->domain**:setMap(map)
    activate domain
    domain- ->service:floor
    deactivate

    service -> repo:save(floor)
    activate repo
    repo->mapper:Map2Data(floor)
    activate mapper
    mapper - -> repo: floorData
    deactivate
    repo->:save(floorData)
    repo->mapper:Map2Model(floorSaved)
    activate mapper
    mapper - -> repo: savedFloor
    deactivate
    repo  - -> service:savedFloor
    deactivate
    service -> mapper:Map2DTO(savedFloor)
    activate mapper
    mapper- -> service:savedFloorDTO
    deactivate
    service- -> controller:savedFloorDTO
    deactivate
    controller - -> route:response(savedFloorDTO as json)
    deactivate
    <- - route:response
    deactivate
@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 WEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: pt
Country: PT
--></g></svg>